<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.leoli.old_classmate.mapper.StudentInfoMapper">
    <resultMap id="StudentInfoResult" type="StudentInfo">
        <id column="id" property="id"/>
        <result column="grade" property="grade"/>
        <result column="schoolfellowId" property="schoolfellowId"/>
        <!--<result column="startDate" jdbcType="TIMESTAMP" property="startDate"/>-->
        <!--<result column="endDate" jdbcType="TIMESTAMP" property="endDate"/>-->

        <association property="school" javaType="School" column="schoolId"
                     select="getSchool">
            <id column="id" jdbcType="VARCHAR" property="id"/>
            <result column="name" jdbcType="VARCHAR" property="name"/>
        </association>

        <association property="sClass" javaType="SchoolClass" column="classId"
                     select="getSclass">
            <id column="classId" jdbcType="VARCHAR" property="id"/>
            <result column="className" jdbcType="VARCHAR" property="name"/>

        </association>
    </resultMap>


    <select id="getStudentInfos" parameterType="java.lang.String" resultMap="StudentInfoResult">
        SELECT si.id              AS id,
               si.grade           AS grade,
               si.schoolfellow_id AS schoolfellowId,
               si.class_id        AS classId,
               si.school_id       AS schoolId
--                si.start_date      AS startDate,
--                si.end_date        AS endDate
        FROM student_info si
        WHERE si.schoolfellow_id = #{id}

    </select>

    <select id="getSchool" parameterType="java.lang.String" resultType="School">
        SELECT id   AS id,
               name AS nama
        FROM school
        WHERE id = #{id};
    </select>

    <select id="getSclass" parameterType="java.lang.String" resultType="SchoolClass">
        SELECT id   AS id,
               name AS nama
        FROM school_class
        WHERE id = #{id};
    </select>


</mapper>